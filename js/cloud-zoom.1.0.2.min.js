(function($){$(document).ready(()=>$('.cloud-zoom, .cloud-zoom-gallery').CloudZoom());function b(A){for(var i=1;i<arguments.length;i++)A=A.replace('%'+(i-1),arguments[i]);return A}function c(_,B){var C=$('img',_),d,E,f=null,g=null,H=null,I=null,j=null,k=null,l,m=0,p=0,q=0,r=0,s=0,t=0;var n,o;var u,v;var W=this,X;setTimeout(function(){if(g===null){var w=_.width();_.parent().append(b('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',w/3,(w/2)-(w/6))).find(':last').css('opacity',0.5)}},200);var Y=function(){k!==null&&(k.remove(),k=null)};this.removeBits=function(){H&&(H.remove(),H=null);I&&(I.remove(),I=null);j&&(j.remove(),j=null);Y();$('.cloud-zoom-loading',_.parent()).remove()};this.destroy=function(){_.data('zoom',null);g&&(g.unbind(),g.remove(),g=null);f&&(f.remove(),f=null);this.removeBits()};this.fadedOut=function(){f&&(f.remove(),f=null);this.removeBits()};this.controlLoop=function(){if(H){var x=(u-C.offset().left-(n*0.5))>>0,y=(v-C.offset().top-(o*0.5))>>0;if(x<0)x=0;else x>(C.outerWidth()-n)&&(x=(C.outerWidth()-n));if(y<0)y=0;else y>(C.outerHeight()-o)&&(y=(C.outerHeight()-o));H.css({left:x,top:y});H.css('background-position',(-x)+'px '+(-y)+'px');p=(((x)/C.outerWidth())*l.width)>>0;q=(((y)/C.outerHeight())*l.height)>>0;s+=(p-s)/B.smoothMove;r+=(q-r)/B.smoothMove;f.css('background-position',(-(s>>0)+'px ')+(-(r>>0)+'px'))}m=setTimeout(function(){W.controlLoop()},30)};this.init2=function(_a,_b){t++;_b===1&&(l=_a);t===2&&this.init()};this.init=function(){$('.cloud-zoom-loading',_.parent()).remove();g=_.parent().append(b('<div class='mousetrap' style='background-image:url(\".\");z-index:999;position:absolute;width:%0px;height:%1px;left:%2px;top:%3px;\'></div>',C.outerWidth(),C.outerHeight(),0,0)).find(':last');var D=!!('ontouchstart' in document.documentElement),_B='touchstart click';g.bind('touchmove mousemove',this,function(e){u=(typeof e.originalEvent.touches!='undefined')?e.originalEvent.touches[0].pageX:e.pageX;v=(typeof e.originalEvent.touches!='undefined')?e.originalEvent.touches[0].pageY:e.pageY});g.bind('touchend mouseleave',this,function(_A){clearTimeout(m);H?.fadeOut(299);I?.fadeOut(299);j?.fadeOut(299);f.fadeOut(300,function(){W.fadedOut();g!=null&&g.css('z-index','auto')});return!1});g.bind('touchstart mouseenter',this,function(aA){g.css('z-index','999');if(D)aA.preventDefault();u=(typeof aA.originalEvent.touches!='undefined')?aA.originalEvent.touches[0].pageX:aA.pageX;v=(typeof aA.originalEvent.touches!='undefined')?aA.originalEvent.touches[0].pageY:aA.pageY;X=aA.data;f&&(f.stop(!0,!1),f.remove());var aB=B.adjustX,_c=B.adjustY;var _d=C.outerWidth(),_e=C.outerHeight(),w=B.zoomWidth,h=B.zoomHeight,_i=!1;B.zoomWidth=='auto'&&(w=_d);B.zoomHeight=='auto'&&(h=_e);var _h=_.parent();switch(B.position) {case 'top':_c-=h;break;case 'right':aB+=_d;break;case 'bottom':_c+=_e;break;case 'left':aB-=w;break;case 'inside':w=_d;h=_e;break;default:_h=$('#'+B.position);!_h.length?(_h=_,aB+=_d,_c+=_e):(w=_h.innerWidth(),h=_h.innerHeight())}f=_h.append(b('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',aB,_c,w,h,l.src)).find(':last');(C.attr('title')&&B.showTitle)&&f.append(b('<div class="cloud-zoom-title">%0</div>',C.attr('title'))).find(':last').css('opacity',B.titleOpacity);($.browser.msie&&$.browser.version<7)&&(k=$('<iframe frameborder="0" src="#"></iframe>').css({position:'absolute',left:aB,top:_c,zIndex:99,width:w,height:h}).insertBefore(f));f.fadeIn(500);H&&(H.remove(),H=null);n=(C.outerWidth()/l.width)*f.width();o=(C.outerHeight()/l.height)*f.height();H=_.append(b('<div class = \'cloud-zoom-lens\' style=\'display:none;z-index:98;position:absolute;width:%0px;height:%1px;\'></div>',n,o)).find(':last');g.css('cursor',H.css('cursor'));B.tint&&(H.css('background',`url("${C.attr('src')}")`),I=_.append(b('<div style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',C.outerWidth(),C.outerHeight(),B.tint)).find(':last'),I.css('opacity',B.tintOpacity),_i=!0,I.fadeIn(500));B.softFocus&&(H.css('background',`url("${C.attr('src')}")`),j=_.append(b('<div style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',C.outerWidth()-2,C.outerHeight()-2,B.tint)).find(':last'),j.css('background',`url("${C.attr('src')}")`),j.css('opacity',0.5),_i=!0,j.fadeIn(500));!_i&&H.css('opacity',B.lensOpacity);B.position!=='inside'&&H.fadeIn(500);X.controlLoop()})};d=new Image();$(d).load(function(){W.init2(this,0)});d.src=C.attr('src');E=new Image();$(E).load(function(){W.init2(this,1)});E.src=_.attr('href')}$.fn.CloudZoom=function(aC){try{document.execCommand('BackgroundImageCache',!1,!0)}catch(e){}this.each(function(){var aD,aE;eval(`var	a = {${$(this).attr('rel')}}`);aD=a;if($(this).is('.cloud-zoom')){$(this).css({'position':'relative','display':'block'});$('img',$(this)).css({'display':'block'});$(this).parent().attr('id')!='wrap'&&$(this).wrap('<div id="wrap" style="top:0px;z-index:auto;position:relative;"></div>');aE=$.extend({},$.fn.CloudZoom.defaults,aC);aE=$.extend({},aE,aD);$(this).data('zoom',new c($(this), aE))}else if($(this).is('.cloud-zoom-gallery')){aE=$.extend({},aD,aC);$(this).data('relOpts',aE);var _C='touchstart click';$(this).bind(_C,$(this),function(aF){var aG=aF.data.data('relOpts');$('#'+aG.useZoom).data('zoom').destroy();$('#'+aG.useZoom).attr('href',aF.data.attr('href'));$('#'+aG.useZoom+' img').attr('src',aF.data.data('relOpts').smallImage);$('#'+aF.data.data('relOpts').useZoom).CloudZoom();return!1})}});return this};$.fn.CloudZoom.defaults={zoomWidth:'auto',zoomHeight:'auto',position:'right',tint:!1,tintOpacity:0.5,lensOpacity:0.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:0.5,adjustX:0,adjustY:0}})(jQuery);
